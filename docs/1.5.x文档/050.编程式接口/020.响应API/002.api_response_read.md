---
title: 读取数据
date: 2022-07-14 14:26:34
permalink: /pages/1.5.x/api_response_read/
---

Forest响应对象提供了多种数据读取的方式，以读取不同类型的数据

### 自定义对象类型

Forest响应对象可以直接读取经过反序列化后的自定义类型的对象

该对象的类型必须和 `ForestResponse<泛型参数>` 中泛型参数指向的类型一致

```java
public interface MyClient {
    /**
     * Get类型请求，url路径为 /test
     * <p>ForestResponse是带泛型参数的类型
     * <p>泛型参数代表返回的响应数据所期望转化成的类型
     * 
     * @return Forest响应对象
     */
    @Get("/test")
    ForestResponse<MyUser> getUser();
}
```

然后通过`getResult`方法获取转换后的对象

> `getResult()` 获取反序列化成对象类型的请求响应内容


```java
// 发送请求，并获取从服务端返回的响应数据对象
ForestResponse<getUser> response = myClient.getUser();
// 获取转换后的响应结果对象
MyUser user = response.getResult();
```

### 字符串类型

> `readAsString()` 以字符串方式读取请求响应内容

```java
// 以字符串方式读取请求响应内容
String content = response.readAsString();
```

### 字节数组类型

> `getByteArray()` 以字节数组的形式获取请求响应内容

```java
// 以字节数组的形式获取请求响应内容
byte[] bytes = response.getByteArray();
```

### 流类型

> `getInputStream() throws Exception` 以输入流的形式获取请求响应内容

:::tip 友情提示
1. 以流的方式读取数据的时候，一定别忘了在读取完毕后<mark>关闭流</mark>
2. 流只能读取一次，关闭流后不能从`response.getInputStream()`以及其它数据读取方法中再次读取
:::

```java
// 以 try-with-resource 方式读取流后，会自动关闭流
try (InputStream in = response.getInputStream()) {
    // 从流中读取字符串数据
    String content = IOUilts.toString(in, StandardCharsets.UTF_8);
} catch (Exception ex) {
    ex.printStackTrace();
}
```

调用`response.close()`方法亦可关闭响应的流

```java
try {
    // 获取响应流
    InputStream in = response.getInputStream()
    // 从流中读取字符串数据
    String content = IOUilts.toString(in, StandardCharsets.UTF_8);
} catch (Exception ex) {
    ex.printStackTrace();
} finally {
    // 关闭响应流
    // 关闭后不可再通过响应对象的数据读取方法获取数据
    response.close();
}
```
